name: dasd

on: 
  pull_request:
    branches:
      - development
      - master  # Run only for pull requests targeting the develop and master branch
    types:
      - synchronize # Trigger when commits are added to the pull request
      - opened # Trigger when a pull request is first opened
      - reopened # Trigger when a previously closed pull request is reopened

jobs:
  build:
    name: "Build Project"
    runs-on: ubuntu-latest

    steps: 
      - name: Get Artifact URL
        id: get-artifact-url
        uses: actions/github-script@v6
        with:
          script: |
            const downloadUrl = "https://api.github.com/repos/Kommunicate-io/Kommunicate-Android-Chat-SDK/actions/artifacts/2355441843";
            const fetch = require('node-fetch'); // Available in github-script
            const response = await fetch(downloadUrl, {
              headers: {
                Authorization: `token ${process.env.GITHUB_TOKEN}`,
              },
            });
            if (response.ok) {
              const buffer = await response.buffer();
              require('fs').writeFileSync('artifact.zip', buffer);
              console.log('Artifact downloaded successfully as artifact.zip');
            } else {
              console.error(`Failed to download artifact: ${response.statusText}`);
            }
        env:
          GITHUB_TOKEN: ${{ secrets.DOWNLOAD_TOKEN }}